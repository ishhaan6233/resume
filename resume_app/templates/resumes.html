{% extends "base.html" %} {% load static %} {% block title %}Resumes -
JobJourney{% endblock %} {% block content %}
<div class="page">
  <!-- Left Panel: Resume list -->
  <div class="left-panel">
    <h2>My Resumes</h2>
    <button class="create-btn" id="create-resume">+ Create Resume</button>

    <div class="resume-card" id="resume-1">
      <h3>Marketing Resume</h3>
      <p class="meta">Last edited: Sep 2025</p>
      <div class="actions">
        <button class="edit-btn">‚úèÔ∏è Edit</button>
        <button class="delete-btn">üóë Delete</button>
      </div>
      <button class="set-active">Set Active</button>
    </div>

    <div class="resume-card" id="resume-2">
      <h3>Data Analyst Resume</h3>
      <p class="meta">Last edited: Aug 2025</p>
      <div class="actions">
        <button class="edit-btn">‚úèÔ∏è Edit</button>
        <button class="delete-btn">üóë Delete</button>
      </div>
      <button class="set-active">Set Active</button>
    </div>
  </div>

  <!-- Right Panel: Resume Preview -->
  <div class="preview-panel" id="preview-panel">
    <div class="preview-header">
      <h2>Resume Preview</h2>
      <button id="download-pdf" data-html2canvas-ignore>
        ‚¨á Download as PDF
      </button>
    </div>
    <hr />

    <!-- Contact Info -->
    <div class="contact" contenteditable="true">
      <span>(123) 456-7890</span>
      <span>example@example.com</span>
      <span>linkedin.com/in/username</span>
    </div>

    <!-- Sections -->
    <div class="section" id="summary">
      <div class="section-controls">
        <button class="move-up-btn">‚¨Ü</button>
        <button class="move-down-btn">‚¨á</button>
      </div>
      <h3>Summary</h3>
      <div class="content" contenteditable="true">
        <p>Write a brief summary about yourself...</p>
      </div>
    </div>

    <div class="section" id="experience">
      <div class="section-controls">
        <button class="move-up-btn">‚¨Ü</button>
        <button class="move-down-btn">‚¨á</button>
      </div>
      <h3>Experience</h3>
      <div class="content">
        <div class="job" contenteditable="true">
          <p class="job-title">Job title @ company</p>
          <p class="job-meta">Location | Date 1 - Date 2</p>
          <ul>
            <li>Describe responsibilities...</li>
          </ul>
          <button class="delete-job-btn">‚úñ</button>
        </div>
      </div>
      <button class="add-job-btn">+ Add Job</button>
    </div>

    <div class="section" id="education">
      <div class="section-controls">
        <button class="move-up-btn">‚¨Ü</button>
        <button class="move-down-btn">‚¨á</button>
      </div>
      <h3>Education</h3>
      <div class="content">
        <div class="education" contenteditable="true">
          <p class="degree">Degree, School</p>
          <p>Date 1 - Date 2</p>
          <button class="delete-education-btn">‚úñ</button>
        </div>
      </div>
      <button class="add-education-btn">+ Add Education</button>
    </div>

    <div class="section" id="skills">
      <div class="section-controls">
        <button class="move-up-btn">‚¨Ü</button>
        <button class="move-down-btn">‚¨á</button>
      </div>
      <h3>Skills</h3>
      <div class="content skills-grid">
        <div class="skill-item" contenteditable="true">
          <p><strong>Category:</strong></p>
          <p>Skills</p>
          <button class="delete-skill-btn">‚úñ</button>
        </div>
      </div>
      <button class="add-skill-btn">+ Add Skill</button>
    </div>

    <!-- Projects -->
    <div class="section" id="projects">
      <div class="section-controls">
        <button class="move-up-btn">‚¨Ü</button>
        <button class="move-down-btn">‚¨á</button>
      </div>
      <h3>Projects</h3>
      <div class="content">
        <div class="project-item" contenteditable="true">
          <p>
            <strong>Project title:</strong>
          </p>
          <ul>
            <li>Bullet point</li>
          </ul>
          <button class="delete-project-btn">‚úñ</button>
        </div>
      </div>
      <button class="add-project-btn">+ Add Project</button>
    </div>
  </div>
</div>

<script>
  // ===== Utility Functions =====
  function createEditableElement(tag, html = "", classes = []) {
    const el = document.createElement(tag);
    el.contentEditable = true;
    el.innerHTML = html;
    if (classes.length) el.classList.add(...classes);
    return el;
  }

  function addSectionItem(sectionSelector, itemClass, htmlTemplate) {
    document.querySelectorAll(sectionSelector).forEach((button) => {
      button.addEventListener("click", () => {
        const section = button.closest(".section");
        const content = section.querySelector(".content");
        const item = createEditableElement("div", htmlTemplate, [itemClass]);
        content.appendChild(item);
      });
    });
  }

  function attachDeleteListener(selector, itemClass) {
    document.addEventListener("click", (e) => {
      if (e.target.classList.contains(selector)) {
        e.target.closest(`.${itemClass}`).remove();
      }
    });
  }

  function moveSection(section, direction) {
    const parent = section.parentNode;
    if (
      direction === "up" &&
      section.previousElementSibling?.classList.contains("section")
    ) {
      parent.insertBefore(section, section.previousElementSibling);
    } else if (
      direction === "down" &&
      section.nextElementSibling?.classList.contains("section")
    ) {
      parent.insertBefore(section.nextElementSibling, section);
    }
    updateMoveButtons();
  }

  function updateMoveButtons() {
    document
      .querySelectorAll(".preview-panel .section")
      .forEach((sec, i, sections) => {
        sec.querySelector(".move-up-btn").disabled = i === 0;
        sec.querySelector(".move-down-btn").disabled =
          i === sections.length - 1;
      });
  }

  // ===== Section Movement =====
  document
    .querySelectorAll(".move-up-btn")
    .forEach((btn) =>
      btn.addEventListener("click", () =>
        moveSection(btn.closest(".section"), "up")
      )
    );
  document
    .querySelectorAll(".move-down-btn")
    .forEach((btn) =>
      btn.addEventListener("click", () =>
        moveSection(btn.closest(".section"), "down")
      )
    );

  // ===== Resume Card Actions =====
  document.querySelectorAll(".resume-card .set-active").forEach((btn) =>
    btn.addEventListener("click", () => {
      document
        .querySelectorAll(".resume-card")
        .forEach((card) => card.classList.remove("active"));
      btn.closest(".resume-card").classList.add("active");
    })
  );

  document
    .querySelectorAll(".resume-card .delete-btn")
    .forEach((btn) =>
      btn.addEventListener("click", () => btn.closest(".resume-card").remove())
    );

  // ===== Add Items =====
  addSectionItem(
    ".add-job-btn",
    "job",
    `
  <p class="job-title">Job title @ company</p>
  <p class="job-meta">Location | Date 1 - Date 2</p>
  <ul><li>Describe responsibilities...</li></ul>
  <button class="delete-job-btn">‚úñ</button>
`
  );

  addSectionItem(
    ".add-education-btn",
    "education",
    `
  <p class="degree">Degree, School</p>
  <p>Date 1 - Date 2</p>
  <button class="delete-education-btn">‚úñ</button>
`
  );

  addSectionItem(
    ".add-skill-btn",
    "skill-item",
    `
  <p><strong>Category:</strong></p>
  <p>Skills</p>
  <button class="delete-skill-btn">‚úñ</button>
`
  );

  addSectionItem(
    ".add-project-btn",
    "project-item",
    `
  <p><strong>Project title:</strong></p>
  <ul><li>Bullet point</li></ul>
  <button class="delete-project-btn">‚úñ</button>
`
  );

  // ===== Delete Items =====
  attachDeleteListener("delete-job-btn", "job");
  attachDeleteListener("delete-education-btn", "education");
  attachDeleteListener("delete-skill-btn", "skill-item");
  attachDeleteListener("delete-project-btn", "project-item");
</script>
{% endblock %}
