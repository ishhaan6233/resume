{% extends "base.html" %} {% block title %}Applications - JobJourney{% endblock %} {% block content %}

<style>
    .notes-box {
    font-size: 14px;
    line-height: 20px;
    font-weight: 400;

    max-height: 100px; /* vertical cap */
    width: 200px; /* constrain width so text wraps */
    overflow-y: auto; /* vertical scroll if needed */
    overflow-x: hidden; /* prevent horizontal overflow */
    white-space: pre-line; /* preserve line breaks */
    word-break: break-word; /* wrap long words */
    display: block; /* ensures width/height apply */
  }
</style>

<h1>Job Applications</h1>

<!-- Tabs -->
<div class="tabs">
  <a
    href="{% url 'applications' %}?status=all"
    class="tab {% if active_filter == 'all' %}active{% endif %}"
    >All</a
  >
  <a
    href="{% url 'applications' %}?status=Applied"
    class="tab {% if active_filter == 'Applied' %}active{% endif %}"
    >Applied</a
  >
  <a
    href="{% url 'applications' %}?status=Interview"
    class="tab {% if active_filter == 'Interview' %}active{% endif %}"
    >Interview</a
  >
  <a
    href="{% url 'applications' %}?status=Offer"
    class="tab {% if active_filter == 'Offer' %}active{% endif %}"
    >Offer</a
  >
  <a
    href="{% url 'applications' %}?status=Rejected"
    class="tab {% if active_filter == 'Rejected' %}active{% endif %}"
    >Rejected</a
  >
</div>

<!-- Action bar -->
<div class="actions">
  <a href="{% url 'add_application' %}" class="btn">+ Add New Application</a>

  <!-- Search form -->
  <form method="get" style="flex: 1; display: flex">
    <input
      type="text"
      name="search"
      value="{{ search_query }}"
      class="search"
      placeholder="Search applications..."
      style="flex: 1; margin-right: 8px"
    />
    <!-- Preserve current tab filter -->
    <input type="hidden" name="status" value="{{ active_filter }}" />
    <button type="submit" class="btn" style="min-width: 100px">Search</button>
  </form>
</div>

<!-- Applications Table -->
<table class="applications-table">
  <thead>
    <tr>
      <th>Company</th>
      <th>Position</th>
      <th>Date Applied</th>
      <th>Status</th>
      <th>Notes</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    {% for app in applications %}
    <tr>
      <td>{{ app.company }}</td>
      <td>{{ app.position }}</td>
      <td>{{ app.date_applied|date:'M d, Y' }}</td>
      <td><span class="status {{ app.status }}">{{ app.status }}</span></td>
      <td>
          <div class="notes-box">{{ app.notes|default:"N/A" }}</div>
        </td>
      <td>
        <a
          href="{% url 'delete_application' app_id=app.id %}"
          class="action-icon"
          onclick="return confirm('Are you sure you want to delete this application?');"
          >üóëÔ∏è</a
        >
      </td>
    </tr>
    {% empty %}
    <tr>
      <td colspan="6">No applications yet.</td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}
